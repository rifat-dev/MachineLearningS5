# Деревья решений
Опишем жадный алгоритм построения бинарного дерева решений:  
1. Начинаем со всей обучающей выборки $X$, которую помещаем в корень $R_1$.   
2. Задаём функционал качества $Q(X, j, t)$ и критерий остановки.   
3. Запускаем построение из корня: $SplitNode(1, R_1)$  

## Задание 4.1
Реализуйте алгоритм построения дерева. Должны быть отдельные функции (методы) для расчёта энтропии (уже есть), для разделения дерева (используйте `pandas`), для подсчёта функционала качества $IG$, для выбора наилучшего разделения (с учетом признакоd и порогов), для проверки критерия остановки.  

Для набора данных `iris` реализуйте алгоритм и минимум три из разными критерия остановки из перечисленных ниже:
* максимальной глубины дерева = 5  
* минимального числа объектов в листе = 5  
* максимальное количество листьев в дереве = 5  
* purity (остановка, если все объекты в листе относятся к одному классу)  

Реализуйте функцию `predict` (на вход функции подаётся датафрейм с объектами)  

Оцените точность каждой модели с помощью метрики точность (`from sklearn.metrics import accuracy_score` или реализовать свою).  

# Случайный лес
## Задание 4.2
В качестве набора данных используйте: https://www.kaggle.com/mathchi/churn-for-bank-customers  

Там есть описание и примеры работы с этими данными. Если кратко, речь идёт про задачу прогнозирования оттока клиентов. Есть данные о 10 тысячах клиентов банка, часть из которых больше не являются клиентами.  

Используя либо свою реализацию, либо  `DecisionTreeClassifier` с разными настройками из `sklearn.tree` реализйте алгоритм "случайный лес".  

Найдите наилучшие гиперпараметры этого алгоритма: количество деревьев, критерий остановки, функционал качества, минимальное количество объектов в листьях и другие.  

Нельзя использовать готовую реализацию случайного леса из `sklearn`.  

В подобных задачах очень важна интерпретируемость алгоритма. Попытайтесь оценить информативность признаков, т.е. ответить а вопрос, значения каких признаков являются самыми важными индикаторами того, что банк потеряет клиента.  

